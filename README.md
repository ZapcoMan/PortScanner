# PortScanner

TCP端口扫描工具，支持端口扫描、Banner识别和CDN检测及绕过功能。

## 功能特点

- TCP端口开放扫描
- 应用服务Banner识别
- CDN技术检测与绕过
- 多线程快速扫描
- 域名和IP地址支持

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

```bash
python PortScan.py -u <目标地址> -p <端口范围> [-T 线程数]
```

参数说明：
- `-u, --url`: 目标IP地址或域名
- `-p, --port`: 端口范围，可以是单个端口(如: 80)或端口范围(如: 21-8080)
- `-T, --threads`: 线程数，默认为100
- `-v, --version`: 显示程序版本
- `-h, --help`: 显示帮助信息

示例：
```bash
python PortScan.py -u 192.168.1.1 -p 1-1000
python PortScan.py -u example.com -p 21-8080
python PortScan.py -u google.com -p 80
python PortScan.py -u 192.168.1.1 -p 1-65535 -T 200
```

## 工作原理

1. **端口扫描**: 使用TCP连接扫描目标主机指定范围内的端口
2. **Banner识别**: 
   - 首先尝试通过HTTP协议获取Banner信息
   - 如果失败，则尝试通过HTTPS协议获取
   - 最后使用原生Socket发送探测包获取Banner
3. **CDN检测**: 通过多DNS服务器解析目标域名，如果返回多个不同IP地址则判定使用了CDN技术
4. **CDN绕过**: 
   - 尝试解析常见子域名以获取真实IP地址
   - 对发现的真实IP进行端口扫描

## 依赖库

- requests
- beautifulsoup4
- lxml
- dnspython
- fake-useragent

安装依赖：
```bash
pip install requests beautifulsoup4 lxml dnspython fake-useragent
```
# 执行示例
```powershell
python .\PortScan.py -u  h-acker.cn -p  21-22                                                                                                                                                                                                   pwsh   98  00:37:27 

                                __       ______                                                             
                               |  \     /      \                                                            
  ______    ______    ______  _| $$_   |  $$$$$$\  _______  ______   _______   _______    ______    ______  
 /      \  /      \  /      \|   $$ \  | $$___\$$ /       \|      \ |       \ |       \  /      \  /      \ 
|  $$$$$$\|  $$$$$$\|  $$$$$$\\$$$$$$   \$$    \ |  $$$$$$$ \$$$$$$\| $$$$$$$\| $$$$$$$\|  $$$$$$\|  $$$$$$\
| $$  | $$| $$  | $$| $$   \$$ | $$ __  _\$$$$$$\| $$      /      $$| $$  | $$| $$  | $$| $$    $$| $$   \$$
| $$__/ $$| $$__/ $$| $$       | $$|  \|  \__| $$| $$_____|  $$$$$$$| $$  | $$| $$  | $$| $$$$$$$$| $$      
| $$    $$ \$$    $$| $$        \$$  $$ \$$    $$ \$$     \\$$    $$| $$  | $$| $$  | $$ \$$     \| $$      
| $$$$$$$   \$$$$$$  \$$         \$$$$   \$$$$$$   \$$$$$$$ \$$$$$$$ \$$   \$$ \$$   \$$  \$$$$$$$ \$$      
| $$                                                                                                        
| $$                                                                                                        
 \$$                                                                                                        


------------------------------------------------------------
[-] 目标使用了CDN技术,尝试绕过...
------------------------------------------------------------
[-] 尝试绕过CDN...
[+] 通过子域名 www.h-acker.cn 发现IP: 103.120.90.181
[+] 通过子域名 www.h-acker.cn 发现IP: 103.120.90.175
[+] 通过子域名 www.h-acker.cn 发现IP: 103.120.90.179
[+] 通过子域名 www.h-acker.cn 发现IP: 103.120.90.183
[+] 通过子域名 www.h-acker.cn 发现IP: 103.120.90.176
[+] 通过子域名 www.h-acker.cn 发现IP: 103.120.90.173
[+] 通过子域名 www.h-acker.cn 发现IP: 103.120.90.174
[+] 通过子域名 www.h-acker.cn 发现IP: 103.120.90.182
[+] 通过子域名 www.h-acker.cn 发现IP: 103.120.90.180
[+] 通过子域名 www.h-acker.cn 发现IP: 103.120.90.177
[+] NS记录: vip1.alidns.com., vip2.alidns.com.
[-] 发现 10 个可能的真实IP，开始扫描...
[-] 扫描IP: 103.120.90.181
------------------------------------------------------------
[-] 正在扫描地址: 103.120.90.181 
------------------------------------------------------------
[+]     22 ---- open   
------------------------------------------------------------
[-] 扫描完成耗时: 14.189382791519165 秒.
[-] 扫描IP: 103.120.90.175
------------------------------------------------------------
[-] 正在扫描地址: 103.120.90.175 
------------------------------------------------------------
[+]     22 ---- open   
------------------------------------------------------------
[-] 扫描完成耗时: 14.648941993713379 秒.
[-] 扫描IP: 103.120.90.179
------------------------------------------------------------
[-] 正在扫描地址: 103.120.90.179 
------------------------------------------------------------
[+]     22 ---- open   
------------------------------------------------------------
[-] 扫描完成耗时: 15.087890863418579 秒.
[-] 扫描IP: 103.120.90.183
------------------------------------------------------------
[-] 正在扫描地址: 103.120.90.183 
------------------------------------------------------------
[+]     22 ---- open   
------------------------------------------------------------
[-] 扫描完成耗时: 15.509053707122803 秒.
[-] 扫描IP: 103.120.90.176
------------------------------------------------------------
[-] 正在扫描地址: 103.120.90.176 
------------------------------------------------------------
[+]     22 ---- open   
------------------------------------------------------------
[-] 扫描完成耗时: 15.935113668441772 秒.
[-] 扫描IP: 103.120.90.173
------------------------------------------------------------
[-] 正在扫描地址: 103.120.90.173 
------------------------------------------------------------
[+]     22 ---- open   
------------------------------------------------------------
[-] 扫描完成耗时: 16.364830017089844 秒.
[-] 扫描IP: 103.120.90.174
------------------------------------------------------------
[-] 正在扫描地址: 103.120.90.174 
------------------------------------------------------------
[+]     22 ---- open   
------------------------------------------------------------
[-] 扫描完成耗时: 16.772014617919922 秒.
[-] 扫描IP: 103.120.90.182
------------------------------------------------------------
[-] 正在扫描地址: 103.120.90.182 
------------------------------------------------------------
[+]     22 ---- open   
------------------------------------------------------------
[-] 扫描完成耗时: 17.200085401535034 秒.
[-] 扫描IP: 103.120.90.180
------------------------------------------------------------
[-] 正在扫描地址: 103.120.90.180 
------------------------------------------------------------
[+]     22 ---- open   
------------------------------------------------------------
[-] 扫描完成耗时: 17.622729063034058 秒.
[-] 扫描IP: 103.120.90.177
------------------------------------------------------------
[-] 正在扫描地址: 103.120.90.177 
------------------------------------------------------------
[+]     22 ---- open   
------------------------------------------------------------
[-] 扫描完成耗时: 18.082566738128662 秒.

```